% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calibration.R
\name{make_base_pi0}
\alias{make_base_pi0}
\title{Construct a base \eqn{\pi_0} estimator function}
\usage{
make_base_pi0(
  type = c("ecdf_storey_median", "ecdf_storey_weighted", "cp4p_st.boot",
    "cp4p_st.spline", "cp4p_langaas", "cp4p_jiang", "cp4p_histo", "cp4p_pounds",
    "cp4p_abh", "cp4p_slim"),
  Lambda = NULL,
  eps = 1e-08,
  nbins = 20,
  pz = 0.05,
  censor = FALSE,
  cp4p_fallback = c("storey_median", "storey_weighted")
)
}
\arguments{
\item{type}{Character string specifying the estimator. One of:
\itemize{
\item \code{"ecdf_storey_median"} — median of Storey(\eqn{\lambda}) over \eqn{\lambda \in \{0.6, 0.7, 0.8\}}
\item \code{"ecdf_storey_weighted"} — weighted Storey(\eqn{\lambda}) over \eqn{\lambda \in \{0.6, 0.7, 0.8, 0.9\}}
\item \code{"cp4p_st.boot"}, \code{"cp4p_st.spline"}, \code{"cp4p_langaas"},
\code{"cp4p_jiang"}, \code{"cp4p_histo"}, \code{"cp4p_pounds"},
\code{"cp4p_abh"}, \code{"cp4p_slim"}
}}

\item{Lambda}{Optional numeric vector of λ values used for ECDF-based
Storey estimators. If \code{NULL}, a default set is chosen depending on \code{type}.}

\item{eps}{Numeric stability value for clipping the estimator to the interval
\eqn{[eps, 1]}. Default: \code{1e-8}.}

\item{nbins}{Number of histogram bins for cp4p estimators. Default: 20.}

\item{pz}{Zero threshold (argument passed to \code{cp4p}). Default: 0.05.}

\item{censor}{Logical. If \code{TRUE}, censor p-values at 1 before passing to cp4p.
Default: \code{FALSE}.}

\item{cp4p_fallback}{Character string specifying which ECDF estimator to use
if cp4p fails (\code{"storey_median"} or \code{"storey_weighted"}).}
}
\value{
A function with signature \verb{function(pvals)} returning a scalar
\eqn{\pi_0} estimate in the interval \eqn{[eps, 1]}.
}
\description{
Creates and returns a function that estimates the null proportion π₀
from a vector of p-values.

There are two types of estimators:
\itemize{
\item \strong{ECDF-based}: Storey-style estimators using multiple
λ thresholds.
\item \strong{cp4p-based}: Flexible density-estimation methods from the
\pkg{cp4p} package, with automatic fallback if that package is not
available or if the estimate fails.
}
}
