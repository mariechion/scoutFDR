% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cqr.R
\name{cqr_upper_bound}
\alias{cqr_upper_bound}
\title{Conformal upper bound for pi0 using CQR and density-ratio stabilisation}
\usage{
cqr_upper_bound(
  cqr_fit,
  cal_df,
  feature_names,
  x0,
  X_target_all,
  alpha = 0.05,
  weight_clip = c(0.2, 2)
)
}
\arguments{
\item{cqr_fit}{Fitted object from \code{\link[=train_cqr_pi0]{train_cqr_pi0()}}.}

\item{cal_df}{Calibration data frame containing \code{pi0} and features.}

\item{feature_names}{Character vector of feature names used in the CQR.}

\item{x0}{Numeric feature vector at which to evaluate the upper bound.
Must be named and at least contain \code{feature_names}.}

\item{X_target_all}{Matrix or data frame of target feature rows,
used for density-ratio (logistic) fitting.}

\item{alpha}{Miscoverage level for the conformal correction.}

\item{weight_clip}{Numeric length-2 vector giving lower and upper
clipping bounds for the importance weights.}
}
\value{
A scalar upper bound on \code{pi0} in \eqn{[0,1]}.
}
\description{
Given a fitted conditional quantile regression model for \code{pi0},
this function computes a conformal upper bound at a target feature
vector \code{x0}. It uses residuals on calibration data, reweighted by
an estimated density ratio between calibration and target feature
distributions, with optional clipping.
}
