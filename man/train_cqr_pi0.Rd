% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calibration.R
\name{train_cqr_pi0}
\alias{train_cqr_pi0}
\title{Train conditional quantile regression for pi0}
\usage{
train_cqr_pi0(cal_df, feature_names, tau = 0.8, model = c("qr", "qrf"))
}
\arguments{
\item{cal_df}{Data frame of calibration samples, typically produced by
\code{\link[=generate_calibration_data]{generate_calibration_data()}}. Must contain column \code{pi0} and the
specified features.}

\item{feature_names}{Character vector giving the names of features in
\code{cal_df} to be considered as predictors.}

\item{tau}{Numeric in \eqn{[0,1]}, the quantile level to model (e.g. 0.8).}

\item{model}{Character string, either \code{"qr"} for linear quantile
regression or \code{"qrf"} for quantile regression forests.}
}
\value{
A list describing the fitted model, with at least the elements
\code{type} (one of \code{"qr"}, \code{"qrf"}, \code{"lm"}),
\code{feature_names}, and model-specific components.
}
\description{
Fits a conditional quantile model for \code{pi0} given features, using
linear quantile regression (via \pkg{quantreg}) when available, and
falling back to quantile regression forests (\pkg{quantregForest})
or an ordinary linear model.
}
\details{
This function assumes that \code{cal_df} contains a column named
\code{pi0} and the specified \code{feature_names}. It performs basic
preprocessing (dropping constant columns, QR-based column selection,
and standardisation for linear quantile regression).
}
